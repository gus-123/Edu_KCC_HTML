<!DOCTYPE html>
<html>
  <head>
    <title>Document</title>
    <meta charset="UTF-8">
  </head>

  <body>
    <label>출발역</label>
    <select id="start"></select>
    <label>도착역</label>
    <select id="end"></select>
    <label><input type="radio" name="group" value="ADULT" checked /> 성인일반</label>
    <label><input type="radio" name="group" value="YOUNG" /> 청소년</label>
    <label><input type="radio" name="group" value="CHILD" /> 어린이</label>
    <div>
      <button onclick="calculate();">요금계산</button>
    </div>
    <div
      id="output"
      style="
        width: 100%;
        height: 150px;
        overflow-y: auto;
        border: 2px solid #222;
      "
    ></div>
    <script>
      const subwayList = [
        "영등포구청역",
        "당산역",
        "합정역",
        "홍대입구역",
        "신촌역",
        "이대역",
        "아현역",
        "충정로역",
        "시청역",
        "을지로3가역",
        "을지로4가역",
        "동대문역사문화공원역",
        "신당역",
        "상왕십리역",
        "왕십리역",
        "한양대역",
        "뚝섬역",
        "성수역",
        "건대입구역",
        "구의역",
        "강변역",
        "잠실나루역",
        "잠실역",
        "종합운동장역",
        "삼성역",
        "선릉역",
        "역삼역",
        "강남역",
        "서초역",
        "방배역",
        "사당역",
        "낙성대역",
        "서울대입구역",
        "봉천역",
        "신림역",
        "신대방역",
        "구로디지털단지역",
        "대림역",
        "신도림역",
        "문래역",
      ];

      const intervalDistance = 3170; //역간 거리(고정)

      
      
      
      /**
       * 지하철 목록을 출발역과 도착역 select 태그에 추가합니다.
       */
      function loadSubways() {
        var h = [];
        for (var idx in subwayList) {
          h.push(`<option value="${idx}">${subwayList[idx]}</option>`);
        }

        document.getElementById("start").innerHTML = h.join("");
        document.getElementById("end").innerHTML = h.join("");
      }

      window.addEventListener("load", function () {
        loadSubways();
      });


      function calculate() {
        //1번 역 추출
        const startElement = document.getElementById('start');
        const endElement = document.getElementById('end');

        const startResult = startElement.value; // 선택된 옵션의 값을 가져옴(즉, 실제 지하철 노선 이름이 아닌 인덱스 값)
        const startStation = subwayList[parseInt(startResult)]; // 실제 지하철 노선 이름 추출

        const endResult = endElement.value;  
        const endStation = subwayList[parseInt(endResult)];

        console.log('선택된 시작역:', startStation);
        console.log('종착역:', endStation);
        
        //2번 역의 갯수 추출
        const subwayNum = endResult - startResult;
        console.log(subwayNum);

        // 3번 이동한 총 거리 구하기
        const subwaydistance = intervalDistance * subwayNum;
        console.log(subwaydistance);

        //5번 추가요금
        const fareTable = {
          ADULT: 1250,
          YOUNG: 720,
          CHILD: 450,
        };
        
        if (10000 >= subwaydistance) { // 10km 이내
          //4번 기본요금
          let total = 0;
          (function fee() {
            const checkedElement = document.querySelector('input[type=radio][name=group]:checked');  
            const selectedAgeGroup = checkedElement.value;
            const fare = fareTable[selectedAgeGroup];
            Math.ceil(total += fare);
            console.log('총 요금:', total, '원');
          })();
        }
        else if (subwaydistance <= 50000) {  // 50km 이내
          let total = 0;
          (function fee() {
            const checkedElement = document.querySelector('input[type=radio][name=group]:checked');  
            const selectedAgeGroup = checkedElement.value;
            const fare = fareTable[selectedAgeGroup];
            let count = ((subwaydistance - 10000) / 5000);
            total = Math.ceil(total + fare + (100 * count));
            console.log('총 요금:', total, '원');
          })();
        }
        else {  // 50km 초과
          total + (40000 / 5000) * 100 +
          Math.ceil((subwaydistance - 50000) / 8000) * 100;
        }
        

        //output.insertAdjacentHTML('beforeend', reasult)
      }

      // window.onload = function() {

      //   const btn = document.getElementsByName('button')  // 필요한 태그 이름 추출

      //   btn.addEventListener("click", calculate, false);  // 이벤트 실행
      // }
    </script>
  </body>
</html>
